{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "This cloud formation template will create a VPC, Subnet and configure and instance that will be used for word press set up",

    "Parameters": {
    },
    "Resources": {
      "WpVPC": {
        "Type": "AWS::EC2::VPC",
        "Properties": {
          "CidrBlock": {"Ref":"VPCCidr"},
          "EnableDnsSupport":"true",
          "EnableDnsHostnames" : "true",
          "InstanceTenancy" : "default",
          "Tags": [{"Key":"Name" , "Value":"Wordpress"}]
        }
      },
      "WpSubnet": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "AvailabilityZone": {"Ref":"AvailabilityZone"},
          "VpcId": {"Ref":"WpVPC"},
          "CidrBlock": {"Ref":"subnetCidr"},
          "Tags": [{"Key":"Name", "Value":"Wordpress"}]
        }
      },
      "WpSecurityGroup" : {
        "Type" : "AWS::EC2::SecurityGroup",
        "Properties" : {
          "GroupDescription" : "Enable HTTP access via port 80 and SSH access if needed",
          "SecurityGroupIngress" : [
            {"IpProtocol" : "tcp", "FromPort" : "80", "ToPort" : "80", "CidrIp" : "0.0.0.0/0"},
            {"IpProtocol" : "tcp", "FromPort" : "22", "ToPort" : "22", "CidrIp" : { "Ref" : "SSHLocation"}}
          ],
          "VpcId" : {"Ref":"WpVPC"},
          "Tags" :  [ {"Key":"Name" , "Value":"Wordpress"}]
        }
      },
      "WpEC2Instance": {
          "Type": "AWS::EC2::Instance",
          "Properties": {
              "KeyName": {"Ref":"KeyName"},
              "DisableApiTermination": "false",
              "ImageId": { "Ref":"ImageId" },
              "SubnetId" : {"Ref":"WpSubnet"},
              "InstanceType": {"Ref":"InstanceType"},
              "Monitoring": "false",
              "SecurityGroupIds" : [ {"Ref" : "WpSecurityGroup"} ],
              "Tags": [
                  {
                      "Key": "Name",
                      "Value": "Wordpress"
                  }
              ],
              "UserData": {
                  "Fn::Base64": {
                      "Fn::Join": [
                          "",
                          [
                              "#!/bin/bash -ex",
                              "-"
                          ]
                      ]
                  }
              }
      }
              }

    },
    "Outputs": {

    }
}
